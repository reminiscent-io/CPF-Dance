| schemaname | tablename                        | policyname                                      | permissive | roles    | cmd    | qual                                                                                                                                                                                                                                                                                                                                                                    | with_check                                                                                                                                                                                                                                                                                                                                      |
| ---------- | -------------------------------- | ----------------------------------------------- | ---------- | -------- | ------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| public     | classes                          | Admins can create classes                       | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                             |
| public     | classes                          | Admins can delete classes                       | PERMISSIVE | {public} | DELETE | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | classes                          | Admins can update all classes                   | PERMISSIVE | {public} | UPDATE | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                             |
| public     | classes                          | Admins can view all classes                     | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | classes                          | Everyone can view active classes                | PERMISSIVE | {public} | SELECT | (is_cancelled = false)                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                                                                            |
| public     | classes                          | Instructors can manage their classes            | PERMISSIVE | {public} | ALL    | (instructor_id = ( SELECT auth.uid() AS uid))                                                                                                                                                                                                                                                                                                                           | (instructor_id = ( SELECT auth.uid() AS uid))                                                                                                                                                                                                                                                                                                   |
| public     | enrollments                      | Admins can manage all enrollments               | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | enrollments                      | Admins can view all enrollments                 | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | enrollments                      | Instructors can delete their class enrollments  | PERMISSIVE | {public} | DELETE | (EXISTS ( SELECT 1
   FROM classes
  WHERE ((classes.id = enrollments.class_id) AND (classes.instructor_id = auth.uid()))))                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                            |
| public     | enrollments                      | Instructors can manage their class enrollments  | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | (EXISTS ( SELECT 1
   FROM classes
  WHERE ((classes.id = enrollments.class_id) AND (classes.instructor_id = auth.uid()))))                                                                                                                                                                                                                     |
| public     | enrollments                      | Instructors can update their class enrollments  | PERMISSIVE | {public} | UPDATE | (EXISTS ( SELECT 1
   FROM classes
  WHERE ((classes.id = enrollments.class_id) AND (classes.instructor_id = auth.uid()))))                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                            |
| public     | enrollments                      | Instructors can view all enrollments            | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | enrollments                      | Instructors can view their class enrollments    | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM classes
  WHERE ((classes.id = enrollments.class_id) AND (classes.instructor_id = auth.uid()))))                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                            |
| public     | enrollments                      | Students can self-enroll                        | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = enrollments.student_id) AND (students.profile_id = auth.uid()))))                                                                                                                                                                                                                   |
| public     | enrollments                      | Students can view their enrollments             | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = enrollments.student_id) AND ((students.profile_id = ( SELECT auth.uid() AS uid)) OR (students.guardian_id = ( SELECT auth.uid() AS uid))))))                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | instructor_student_relationships | Admins and instructors can manage relationships | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = ANY (ARRAY['admin'::user_role, 'instructor'::user_role])))))                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                                                                            |
| public     | instructor_student_relationships | Admins can create relationships                 | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                             |
| public     | instructor_student_relationships | Dancers can view their relationships            | PERMISSIVE | {public} | SELECT | (student_id IN ( SELECT students.id
   FROM students
  WHERE (students.profile_id = auth.uid())))                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                                                                            |
| public     | instructor_student_relationships | Instructors can create relationships            | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                        |
| public     | notes                            | Admins can manage all notes                     | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | notes                            | Admins can view all notes                       | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | notes                            | Instructors can create notes for their students | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | ((author_id = auth.uid()) AND ((student_id IS NULL) OR (EXISTS ( SELECT 1
   FROM instructor_student_relationships
  WHERE ((instructor_student_relationships.student_id = notes.student_id) AND (instructor_student_relationships.instructor_id = auth.uid()) AND (instructor_student_relationships.relationship_status = 'active'::text)))))) |
| public     | notes                            | Instructors can manage all notes                | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | notes                            | Instructors can manage notes                    | PERMISSIVE | {public} | ALL    | (author_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | notes                            | Instructors can view all notes                  | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | notes                            | Students can create self notes                  | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | ((author_id = auth.uid()) AND (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = notes.student_id) AND (students.profile_id = auth.uid())))))                                                                                                                                                                                          |
| public     | notes                            | Students can view shared notes about them       | PERMISSIVE | {public} | SELECT | ((EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = notes.student_id) AND ((students.profile_id = ( SELECT auth.uid() AS uid)) OR (students.guardian_id = ( SELECT auth.uid() AS uid))) AND (notes.visibility = ANY (ARRAY['shared_with_student'::note_visibility, 'shared_with_guardian'::note_visibility]))))) OR (author_id = ( SELECT auth.uid() AS uid))) | null                                                                                                                                                                                                                                                                                                                                            |
| public     | notes                            | Students can view their notes                   | PERMISSIVE | {public} | SELECT | ((author_id = auth.uid()) OR ((student_id IS NOT NULL) AND (EXISTS ( SELECT 1
   FROM students s
  WHERE ((s.id = notes.student_id) AND ((s.profile_id = auth.uid()) OR (s.guardian_id = auth.uid())) AND (notes.visibility = ANY (ARRAY['shared_with_student'::note_visibility, 'shared_with_guardian'::note_visibility])))))))                                        | null                                                                                                                                                                                                                                                                                                                                            |
| public     | notes                            | Students can view their own notes               | PERMISSIVE | {public} | SELECT | ((author_id = auth.uid()) OR ((student_id IS NOT NULL) AND (EXISTS ( SELECT 1
   FROM students s
  WHERE ((s.id = notes.student_id) AND ((s.profile_id = auth.uid()) OR (s.guardian_id = auth.uid())))))))                                                                                                                                                              | null                                                                                                                                                                                                                                                                                                                                            |
| public     | notes                            | Studio users can view notes shared with studio  | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'studio_admin'::user_role) AND (notes.visibility = 'shared_with_studio'::note_visibility))))                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                                                                            |
| public     | payment_events                   | Admins can create payment events                | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                             |
| public     | payment_events                   | Admins can manage payment events                | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | payment_events                   | Admins can view all payment events              | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | payment_events                   | Instructors can create payment events           | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                        |
| public     | payment_events                   | Instructors can view payment events             | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | payment_events                   | Instructors can view student payment events     | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM (payments p
     JOIN instructor_student_relationships isr ON ((p.student_id = isr.student_id)))
  WHERE ((p.id = payment_events.payment_id) AND (isr.instructor_id = auth.uid()) AND (isr.relationship_status = 'active'::text) AND (isr.can_view_payments = true))))                                                                       | null                                                                                                                                                                                                                                                                                                                                            |
| public     | payment_events                   | Students can view their payment events          | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM (payments p
     JOIN students s ON ((p.student_id = s.id)))
  WHERE ((p.id = payment_events.payment_id) AND ((s.profile_id = auth.uid()) OR (s.guardian_id = auth.uid())))))                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | payment_events                   | Studio admins can view studio payment events    | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'studio_admin'::user_role))))                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                                                                                                            |
| public     | payments                         | Students can view their payments                | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = payments.student_id) AND ((students.profile_id = ( SELECT auth.uid() AS uid)) OR (students.guardian_id = ( SELECT auth.uid() AS uid))))))                                                                                                                                                                   | null                                                                                                                                                                                                                                                                                                                                            |
| public     | personal_classes                 | Students can create their own personal classes  | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = personal_classes.student_id) AND ((students.profile_id = auth.uid()) OR (students.guardian_id = auth.uid())))))                                                                                                                                                                     |
| public     | personal_classes                 | Students can delete their own personal classes  | PERMISSIVE | {public} | DELETE | (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = personal_classes.student_id) AND ((students.profile_id = auth.uid()) OR (students.guardian_id = auth.uid())))))                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                            |
| public     | personal_classes                 | Students can update their own personal classes  | PERMISSIVE | {public} | UPDATE | (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = personal_classes.student_id) AND ((students.profile_id = auth.uid()) OR (students.guardian_id = auth.uid())))))                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                            |
| public     | personal_classes                 | Students can view their own personal classes    | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = personal_classes.student_id) AND ((students.profile_id = auth.uid()) OR (students.guardian_id = auth.uid())))))                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                            |
| public     | private_lesson_requests          | Admins can manage all private lesson requests   | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | private_lesson_requests          | Admins can manage requests                      | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | private_lesson_requests          | Instructors can manage requests                 | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | private_lesson_requests          | Instructors can manage their requests           | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM instructor_student_relationships
  WHERE ((instructor_student_relationships.student_id = private_lesson_requests.student_id) AND (instructor_student_relationships.instructor_id = auth.uid()) AND (instructor_student_relationships.relationship_status = 'active'::text))))                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | private_lesson_requests          | Instructors can view requests                   | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | private_lesson_requests          | Students can create requests                    | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = private_lesson_requests.student_id) AND ((students.profile_id = ( SELECT auth.uid() AS uid)) OR (students.guardian_id = ( SELECT auth.uid() AS uid))))))                                                                                                                            |
| public     | private_lesson_requests          | Students can update their requests              | PERMISSIVE | {public} | UPDATE | (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = private_lesson_requests.student_id) AND (students.profile_id = auth.uid()))))                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                                                                            |
| public     | private_lesson_requests          | Students can view their own requests            | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = private_lesson_requests.student_id) AND ((students.profile_id = ( SELECT auth.uid() AS uid)) OR (students.guardian_id = ( SELECT auth.uid() AS uid))))))                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                            |
| public     | private_lesson_requests          | Students can view their requests                | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM students
  WHERE ((students.id = private_lesson_requests.student_id) AND ((students.profile_id = auth.uid()) OR (students.guardian_id = auth.uid())))))                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                            |
| public     | profiles                         | Admin users can update their profile            | PERMISSIVE | {public} | UPDATE | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = ( SELECT auth.uid() AS uid)) AND (p.role = 'admin'::user_role))))                                                                                                                                                                                                                                                | (EXISTS ( SELECT 1
   FROM profiles p
  WHERE ((p.id = ( SELECT auth.uid() AS uid)) AND (p.role = 'admin'::user_role))))                                                                                                                                                                                                                        |
| public     | profiles                         | Admins can update any profile                   | PERMISSIVE | {public} | UPDATE | (EXISTS ( SELECT 1
   FROM profiles profiles_1
  WHERE ((profiles_1.id = ( SELECT auth.uid() AS uid)) AND (profiles_1.role = 'admin'::user_role))))                                                                                                                                                                                                                     | (EXISTS ( SELECT 1
   FROM profiles profiles_1
  WHERE ((profiles_1.id = ( SELECT auth.uid() AS uid)) AND (profiles_1.role = 'admin'::user_role))))                                                                                                                                                                                             |
| public     | profiles                         | Admins can view any profile                     | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles profiles_1
  WHERE ((profiles_1.id = ( SELECT auth.uid() AS uid)) AND (profiles_1.role = 'admin'::user_role))))                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | profiles                         | Anyone can view instructor profiles             | PERMISSIVE | {public} | SELECT | (role = ANY (ARRAY['instructor'::user_role, 'admin'::user_role]))                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                                                                            |
| public     | profiles                         | Guardians can view their dancer profiles        | PERMISSIVE | {public} | SELECT | (guardian_id = ( SELECT auth.uid() AS uid))                                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                            |
| public     | profiles                         | Instructors can view all profiles               | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles profiles_1
  WHERE ((profiles_1.id = ( SELECT auth.uid() AS uid)) AND (profiles_1.role = 'instructor'::user_role))))                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | profiles                         | Users can update their own profile              | PERMISSIVE | {public} | UPDATE | (id = ( SELECT auth.uid() AS uid))                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                            |
| public     | profiles                         | Users can view all profiles                     | PERMISSIVE | {public} | SELECT | true                                                                                                                                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                            |
| public     | profiles                         | Users can view their own profile                | PERMISSIVE | {public} | SELECT | (id = ( SELECT auth.uid() AS uid))                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                            |
| public     | students                         | Admins can manage all students                  | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | students                         | Admins can view all students                    | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | students                         | Dancers can view themselves                     | PERMISSIVE | {public} | SELECT | (profile_id = auth.uid())                                                                                                                                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                                                                            |
| public     | students                         | Instructors can create students                 | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                        |
| public     | students                         | Instructors can delete students                 | PERMISSIVE | {public} | DELETE | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | students                         | Instructors can update students                 | PERMISSIVE | {public} | UPDATE | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                        |
| public     | students                         | Instructors can view all students               | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | students                         | Instructors can view their students             | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | students                         | Students can view their own student record      | PERMISSIVE | {public} | SELECT | ((profile_id = ( SELECT auth.uid() AS uid)) OR (guardian_id = ( SELECT auth.uid() AS uid)))                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                            |
| public     | students                         | Students can view themselves                    | PERMISSIVE | {public} | SELECT | ((profile_id = auth.uid()) OR (guardian_id = auth.uid()))                                                                                                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studio_inquiries                 | Admins can manage all inquiries                 | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studio_inquiries                 | Admins can manage all studio inquiries          | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studio_inquiries                 | Admins can manage studio inquiries              | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studio_inquiries                 | Admins can view all studio inquiries            | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studio_inquiries                 | Admins can view studio inquiries                | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studio_inquiries                 | Anyone can create studio inquiries              | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | true                                                                                                                                                                                                                                                                                                                                            |
| public     | studio_inquiries                 | Instructors can view studio inquiries           | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studio_inquiries                 | Public can create inquiries                     | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | true                                                                                                                                                                                                                                                                                                                                            |
| public     | studio_inquiries                 | Studio can view their inquiries                 | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'studio_admin'::user_role))))                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studios                          | Admins can manage all studios                   | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = ( SELECT auth.uid() AS uid)) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studios                          | Admins can manage studios                       | PERMISSIVE | {public} | ALL    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = ( SELECT auth.uid() AS uid)) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studios                          | Admins can view all studios                     | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = ( SELECT auth.uid() AS uid)) AND (profiles.role = 'admin'::user_role))))                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studios                          | Instructors can create studios                  | PERMISSIVE | {public} | INSERT | null                                                                                                                                                                                                                                                                                                                                                                    | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = ( SELECT auth.uid() AS uid)) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                       |
| public     | studios                          | Instructors can update studios                  | PERMISSIVE | {public} | UPDATE | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = ( SELECT auth.uid() AS uid)) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studios                          | Instructors can view all studios                | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'instructor'::user_role))))                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studios                          | Public can view studios                         | PERMISSIVE | {public} | SELECT | true                                                                                                                                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studios                          | Studio admins can update their studio           | PERMISSIVE | {public} | UPDATE | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'studio_admin'::user_role))))                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                                                                                                            |
| public     | studios                          | Studio admins can view studios                  | PERMISSIVE | {public} | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'studio_admin'::user_role))))                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                                                                                                            |